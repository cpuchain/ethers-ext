globalThis.process?.browser||(globalThis.process={browser:!0,env:{}}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ethExt=t():e.ethExt=t()}(self,(()=>(()=>{var e={277:()=>{},401:()=>{}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var i=t[a]={exports:{}};return e[a](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};return(()=>{"use strict";n.r(a),n.d(a,{ARB_CHAIN:()=>Te,ARB_GAS_LIMIT:()=>be,BrowserProvider:()=>xe,CreateX__factory:()=>d,DEFAULT_GAS_LIMIT:()=>he,DEFAULT_GAS_LIMIT_BUMP:()=>ge,DEFAULT_GAS_PRICE_BUMP:()=>fe,ERC20__factory:()=>h,EthersBatcher:()=>te,FeeDataExt:()=>je,GAS_LIMIT_FAILOVER:()=>we,GAS_PRICE_ORACLE_ADDRESS:()=>se,IDB_ERR:()=>Be,IndexedDB:()=>ke,JsonRpcSigner:()=>Ie,MULTICALL_ADDRESS:()=>Se,Multicall__factory:()=>v,OFFCHAIN_ORACLE_ADDRESS:()=>De,OffchainOracle__factory:()=>A,OpGasPriceOracle__factory:()=>B,Permit2__factory:()=>O,Provider:()=>qe,VoidSigner:()=>Ce,Wallet:()=>Pe,assert:()=>s,assertArgument:()=>p,base64ToBytes:()=>X,base64ToHex:()=>z,bufferToBytes:()=>H,bytesToBase64:()=>Q,bytesToHex:()=>q,chunk:()=>D,concatBytes:()=>V,crypto:()=>N,digest:()=>L,digestHex:()=>W,ethers:()=>r,factories:()=>e,formatFeeHistory:()=>Fe,getL1Fee:()=>pe,getRateToEth:()=>_e,getSubInfo:()=>y,hexToBase64:()=>J,hexToBytes:()=>j,isDeferred:()=>o,isNode:()=>G,multiQueryFilter:()=>ee,multicall:()=>Ee,permit:()=>Ge,populateTransaction:()=>ve,rBytes:()=>U,sleep:()=>_,switchChain:()=>Me,toFixedHex:()=>$});var e={};n.r(e),n.d(e,{CreateX__factory:()=>d,ERC20__factory:()=>h,Multicall__factory:()=>v,OffchainOracle__factory:()=>A,OpGasPriceOracle__factory:()=>B,Permit2__factory:()=>O});var t=n(277);const r=globalThis?.ethers||t.ethers,{isHexString:i}=r;function s(e,t,n,a){if(!e)throw r.makeError(t,n,a)}function p(e,t,n,a){s(e,t,"INVALID_ARGUMENT",{argument:n,value:a})}function o(e){return e&&"object"==typeof e&&"getTopicFilter"in e&&"function"==typeof e.getTopicFilter&&e.fragment}async function y(e,t){let n,a=null;if(Array.isArray(t)){const a=function(t){if(i(t,32))return t;const n=e.getEvent(t);return p(n,"unknown fragment","name",t),n.topicHash};n=t.map((e=>null==e?null:Array.isArray(e)?e.map(a):a(e)))}else"*"===t?n=[null]:"string"==typeof t?i(t,32)?n=[t]:(a=e.getEvent(t),p(a,"unknown fragment","event",t),n=[a.topicHash]):o(t)?n=await t.getTopicFilter():"fragment"in t?(a=t.fragment,n=[a.topicHash]):p(!1,"unknown event name","event",t);return n=n.map((e=>{if(null==e)return null;if(Array.isArray(e)){const t=Array.from(new Set(e.map((e=>e.toLowerCase()))).values());return 1===t.length?t[0]:(t.sort(),t)}return e.toLowerCase()})),{fragment:a,tag:n.map((e=>null==e?"null":Array.isArray(e)?e.join("|"):e)).join("&"),topics:n}}const{Contract:u,Interface:l}=r,c=[{inputs:[{internalType:"address",name:"emitter",type:"address"}],name:"FailedContractCreation",type:"error"},{inputs:[{internalType:"address",name:"emitter",type:"address"},{internalType:"bytes",name:"revertData",type:"bytes"}],name:"FailedContractInitialisation",type:"error"},{inputs:[{internalType:"address",name:"emitter",type:"address"},{internalType:"bytes",name:"revertData",type:"bytes"}],name:"FailedEtherTransfer",type:"error"},{inputs:[{internalType:"address",name:"emitter",type:"address"}],name:"InvalidNonceValue",type:"error"},{inputs:[{internalType:"address",name:"emitter",type:"address"}],name:"InvalidSalt",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newContract",type:"address"},{indexed:!0,internalType:"bytes32",name:"salt",type:"bytes32"}],name:"ContractCreation",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newContract",type:"address"}],name:"ContractCreation",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newContract",type:"address"},{indexed:!0,internalType:"bytes32",name:"salt",type:"bytes32"}],name:"Create3ProxyContractCreation",type:"event"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes32",name:"initCodeHash",type:"bytes32"}],name:"computeCreate2Address",outputs:[{internalType:"address",name:"computedAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes32",name:"initCodeHash",type:"bytes32"},{internalType:"address",name:"deployer",type:"address"}],name:"computeCreate2Address",outputs:[{internalType:"address",name:"computedAddress",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"address",name:"deployer",type:"address"}],name:"computeCreate3Address",outputs:[{internalType:"address",name:"computedAddress",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"}],name:"computeCreate3Address",outputs:[{internalType:"address",name:"computedAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"nonce",type:"uint256"}],name:"computeCreateAddress",outputs:[{internalType:"address",name:"computedAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"deployer",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"}],name:"computeCreateAddress",outputs:[{internalType:"address",name:"computedAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"}],name:"deployCreate",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes",name:"initCode",type:"bytes"}],name:"deployCreate2",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"}],name:"deployCreate2",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"},{internalType:"address",name:"refundAddress",type:"address"}],name:"deployCreate2AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"}],name:"deployCreate2AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"},{internalType:"address",name:"refundAddress",type:"address"}],name:"deployCreate2AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"}],name:"deployCreate2AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"address",name:"implementation",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"deployCreate2Clone",outputs:[{internalType:"address",name:"proxy",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"implementation",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"deployCreate2Clone",outputs:[{internalType:"address",name:"proxy",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"}],name:"deployCreate3",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes",name:"initCode",type:"bytes"}],name:"deployCreate3",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"}],name:"deployCreate3AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"}],name:"deployCreate3AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"},{internalType:"address",name:"refundAddress",type:"address"}],name:"deployCreate3AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"},{internalType:"address",name:"refundAddress",type:"address"}],name:"deployCreate3AndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"}],name:"deployCreateAndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"data",type:"bytes"},{components:[{internalType:"uint256",name:"constructorAmount",type:"uint256"},{internalType:"uint256",name:"initCallAmount",type:"uint256"}],internalType:"struct CreateX.Values",name:"values",type:"tuple"},{internalType:"address",name:"refundAddress",type:"address"}],name:"deployCreateAndInit",outputs:[{internalType:"address",name:"newContract",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"implementation",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"deployCreateClone",outputs:[{internalType:"address",name:"proxy",type:"address"}],stateMutability:"payable",type:"function"}];class d{static abi=c;static createInterface(){return new l(c)}static connect(e,t){return new u(e,c,t)}}const{Contract:m,Interface:T}=r,b=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"nonces",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}];class h{static abi=b;static createInterface(){return new T(b)}static connect(e,t){return new m(e,b,t)}}const{Contract:f,Interface:g}=r,w=[{inputs:[{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Multicall3.Call[]",name:"calls",type:"tuple[]"}],name:"aggregate",outputs:[{internalType:"uint256",name:"blockNumber",type:"uint256"},{internalType:"bytes[]",name:"returnData",type:"bytes[]"}],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bool",name:"allowFailure",type:"bool"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Multicall3.Call3[]",name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"returnData",type:"bytes"}],internalType:"struct Multicall3.Result[]",name:"returnData",type:"tuple[]"}],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bool",name:"allowFailure",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Multicall3.Call3Value[]",name:"calls",type:"tuple[]"}],name:"aggregate3Value",outputs:[{components:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"returnData",type:"bytes"}],internalType:"struct Multicall3.Result[]",name:"returnData",type:"tuple[]"}],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Multicall3.Call[]",name:"calls",type:"tuple[]"}],name:"blockAndAggregate",outputs:[{internalType:"uint256",name:"blockNumber",type:"uint256"},{internalType:"bytes32",name:"blockHash",type:"bytes32"},{components:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"returnData",type:"bytes"}],internalType:"struct Multicall3.Result[]",name:"returnData",type:"tuple[]"}],stateMutability:"payable",type:"function"},{inputs:[],name:"getBasefee",outputs:[{internalType:"uint256",name:"basefee",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"blockNumber",type:"uint256"}],name:"getBlockHash",outputs:[{internalType:"bytes32",name:"blockHash",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getBlockNumber",outputs:[{internalType:"uint256",name:"blockNumber",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getChainId",outputs:[{internalType:"uint256",name:"chainid",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockCoinbase",outputs:[{internalType:"address",name:"coinbase",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockDifficulty",outputs:[{internalType:"uint256",name:"difficulty",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockGasLimit",outputs:[{internalType:"uint256",name:"gaslimit",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockTimestamp",outputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"getEthBalance",outputs:[{internalType:"uint256",name:"balance",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastBlockHash",outputs:[{internalType:"bytes32",name:"blockHash",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bool",name:"requireSuccess",type:"bool"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Multicall3.Call[]",name:"calls",type:"tuple[]"}],name:"tryAggregate",outputs:[{components:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"returnData",type:"bytes"}],internalType:"struct Multicall3.Result[]",name:"returnData",type:"tuple[]"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bool",name:"requireSuccess",type:"bool"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Multicall3.Call[]",name:"calls",type:"tuple[]"}],name:"tryBlockAndAggregate",outputs:[{internalType:"uint256",name:"blockNumber",type:"uint256"},{internalType:"bytes32",name:"blockHash",type:"bytes32"},{components:[{internalType:"bool",name:"success",type:"bool"},{internalType:"bytes",name:"returnData",type:"bytes"}],internalType:"struct Multicall3.Result[]",name:"returnData",type:"tuple[]"}],stateMutability:"payable",type:"function"}];class v{static abi=w;static createInterface(){return new g(w)}static connect(e,t){return new f(e,w,t)}}const{Contract:P,Interface:C}=r,I=[{inputs:[{internalType:"contract MultiWrapper",name:"_multiWrapper",type:"address"},{internalType:"contract IOracle[]",name:"existingOracles",type:"address[]"},{internalType:"enum OffchainOracle.OracleType[]",name:"oracleTypes",type:"uint8[]"},{internalType:"contract IERC20[]",name:"existingConnectors",type:"address[]"},{internalType:"contract IERC20",name:"wBase",type:"address"},{internalType:"address",name:"owner_",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"ArraysLengthMismatch",type:"error"},{inputs:[],name:"ConnectorAlreadyAdded",type:"error"},{inputs:[],name:"InvalidOracleTokenKind",type:"error"},{inputs:[],name:"MathOverflowedMulDiv",type:"error"},{inputs:[],name:"OracleAlreadyAdded",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{inputs:[],name:"SameTokens",type:"error"},{inputs:[],name:"TooBigThreshold",type:"error"},{inputs:[],name:"UnknownConnector",type:"error"},{inputs:[],name:"UnknownOracle",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IERC20",name:"connector",type:"address"}],name:"ConnectorAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IERC20",name:"connector",type:"address"}],name:"ConnectorRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract MultiWrapper",name:"multiWrapper",type:"address"}],name:"MultiWrapperUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IOracle",name:"oracle",type:"address"},{indexed:!1,internalType:"enum OffchainOracle.OracleType",name:"oracleType",type:"uint8"}],name:"OracleAdded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IOracle",name:"oracle",type:"address"},{indexed:!1,internalType:"enum OffchainOracle.OracleType",name:"oracleType",type:"uint8"}],name:"OracleRemoved",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{inputs:[{internalType:"contract IERC20",name:"connector",type:"address"}],name:"addConnector",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IOracle",name:"oracle",type:"address"},{internalType:"enum OffchainOracle.OracleType",name:"oracleKind",type:"uint8"}],name:"addOracle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"connectors",outputs:[{internalType:"contract IERC20[]",name:"allConnectors",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"contract IERC20",name:"dstToken",type:"address"},{internalType:"bool",name:"useWrappers",type:"bool"}],name:"getRate",outputs:[{internalType:"uint256",name:"weightedRate",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"bool",name:"useSrcWrappers",type:"bool"}],name:"getRateToEth",outputs:[{internalType:"uint256",name:"weightedRate",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"bool",name:"useSrcWrappers",type:"bool"},{internalType:"contract IERC20[]",name:"customConnectors",type:"address[]"},{internalType:"uint256",name:"thresholdFilter",type:"uint256"}],name:"getRateToEthWithCustomConnectors",outputs:[{internalType:"uint256",name:"weightedRate",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"bool",name:"useSrcWrappers",type:"bool"},{internalType:"uint256",name:"thresholdFilter",type:"uint256"}],name:"getRateToEthWithThreshold",outputs:[{internalType:"uint256",name:"weightedRate",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"contract IERC20",name:"dstToken",type:"address"},{internalType:"bool",name:"useWrappers",type:"bool"},{internalType:"contract IERC20[]",name:"customConnectors",type:"address[]"},{internalType:"uint256",name:"thresholdFilter",type:"uint256"}],name:"getRateWithCustomConnectors",outputs:[{internalType:"uint256",name:"weightedRate",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"contract IERC20",name:"dstToken",type:"address"},{internalType:"bool",name:"useWrappers",type:"bool"},{internalType:"uint256",name:"thresholdFilter",type:"uint256"}],name:"getRateWithThreshold",outputs:[{internalType:"uint256",name:"weightedRate",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"bool",name:"useSrcWrappers",type:"bool"},{internalType:"contract IERC20[]",name:"customConnectors",type:"address[]"},{internalType:"uint256",name:"thresholdFilter",type:"uint256"}],name:"getRatesAndWeightsToEthWithCustomConnectors",outputs:[{internalType:"uint256",name:"wrappedPrice",type:"uint256"},{components:[{internalType:"uint256",name:"maxOracleWeight",type:"uint256"},{internalType:"uint256",name:"size",type:"uint256"},{components:[{internalType:"uint256",name:"rate",type:"uint256"},{internalType:"uint256",name:"weight",type:"uint256"}],internalType:"struct OraclePrices.OraclePrice[]",name:"oraclePrices",type:"tuple[]"}],internalType:"struct OraclePrices.Data",name:"ratesAndWeights",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"srcToken",type:"address"},{internalType:"contract IERC20",name:"dstToken",type:"address"},{internalType:"bool",name:"useWrappers",type:"bool"},{internalType:"contract IERC20[]",name:"customConnectors",type:"address[]"},{internalType:"uint256",name:"thresholdFilter",type:"uint256"}],name:"getRatesAndWeightsWithCustomConnectors",outputs:[{internalType:"uint256",name:"wrappedPrice",type:"uint256"},{components:[{internalType:"uint256",name:"maxOracleWeight",type:"uint256"},{internalType:"uint256",name:"size",type:"uint256"},{components:[{internalType:"uint256",name:"rate",type:"uint256"},{internalType:"uint256",name:"weight",type:"uint256"}],internalType:"struct OraclePrices.OraclePrice[]",name:"oraclePrices",type:"tuple[]"}],internalType:"struct OraclePrices.Data",name:"ratesAndWeights",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"multiWrapper",outputs:[{internalType:"contract MultiWrapper",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"oracles",outputs:[{internalType:"contract IOracle[]",name:"allOracles",type:"address[]"},{internalType:"enum OffchainOracle.OracleType[]",name:"oracleTypes",type:"uint8[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IERC20",name:"connector",type:"address"}],name:"removeConnector",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract IOracle",name:"oracle",type:"address"},{internalType:"enum OffchainOracle.OracleType",name:"oracleKind",type:"uint8"}],name:"removeOracle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"contract MultiWrapper",name:"_multiWrapper",type:"address"}],name:"setMultiWrapper",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}];class A{static abi=I;static createInterface(){return new C(I)}static connect(e,t){return new P(e,I,t)}}const{Contract:M,Interface:x}=r,F=[{inputs:[],name:"DECIMALS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"baseFeeScalar",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"blobBaseFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"blobBaseFeeScalar",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[],name:"gasPrice",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"_data",type:"bytes"}],name:"getL1Fee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_unsignedTxSize",type:"uint256"}],name:"getL1FeeUpperBound",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"_data",type:"bytes"}],name:"getL1GasUsed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"isEcotone",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"isFjord",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"l1BaseFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"overhead",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"scalar",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"setEcotone",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"setFjord",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}];class B{static abi=F;static createInterface(){return new x(F)}static connect(e,t){return new M(e,F,t)}}const{Contract:k,Interface:S}=r,E=[{inputs:[{internalType:"uint256",name:"deadline",type:"uint256"}],name:"AllowanceExpired",type:"error"},{inputs:[],name:"ExcessiveInvalidation",type:"error"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"InsufficientAllowance",type:"error"},{inputs:[{internalType:"uint256",name:"maxAmount",type:"uint256"}],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidContractSignature",type:"error"},{inputs:[],name:"InvalidNonce",type:"error"},{inputs:[],name:"InvalidSignature",type:"error"},{inputs:[],name:"InvalidSignatureLength",type:"error"},{inputs:[],name:"InvalidSigner",type:"error"},{inputs:[],name:"LengthMismatch",type:"error"},{inputs:[{internalType:"uint256",name:"signatureDeadline",type:"uint256"}],name:"SignatureExpired",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint160",name:"amount",type:"uint160"},{indexed:!1,internalType:"uint48",name:"expiration",type:"uint48"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"address",name:"spender",type:"address"}],name:"Lockdown",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint48",name:"newNonce",type:"uint48"},{indexed:!1,internalType:"uint48",name:"oldNonce",type:"uint48"}],name:"NonceInvalidation",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"token",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint160",name:"amount",type:"uint160"},{indexed:!1,internalType:"uint48",name:"expiration",type:"uint48"},{indexed:!1,internalType:"uint48",name:"nonce",type:"uint48"}],name:"Permit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"word",type:"uint256"},{indexed:!1,internalType:"uint256",name:"mask",type:"uint256"}],name:"UnorderedNonceInvalidation",type:"event"},{inputs:[],name:"DOMAIN_SEPARATOR",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowance",outputs:[{internalType:"uint160",name:"amount",type:"uint160"},{internalType:"uint48",name:"expiration",type:"uint48"},{internalType:"uint48",name:"nonce",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint160",name:"amount",type:"uint160"},{internalType:"uint48",name:"expiration",type:"uint48"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint48",name:"newNonce",type:"uint48"}],name:"invalidateNonces",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"wordPos",type:"uint256"},{internalType:"uint256",name:"mask",type:"uint256"}],name:"invalidateUnorderedNonces",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"spender",type:"address"}],internalType:"struct IAllowanceTransfer.TokenSpenderPair[]",name:"approvals",type:"tuple[]"}],name:"lockdown",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"nonceBitmap",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{components:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint160",name:"amount",type:"uint160"},{internalType:"uint48",name:"expiration",type:"uint48"},{internalType:"uint48",name:"nonce",type:"uint48"}],internalType:"struct IAllowanceTransfer.PermitDetails[]",name:"details",type:"tuple[]"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"sigDeadline",type:"uint256"}],internalType:"struct IAllowanceTransfer.PermitBatch",name:"permitBatch",type:"tuple"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{components:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint160",name:"amount",type:"uint160"},{internalType:"uint48",name:"expiration",type:"uint48"},{internalType:"uint48",name:"nonce",type:"uint48"}],internalType:"struct IAllowanceTransfer.PermitDetails",name:"details",type:"tuple"},{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"sigDeadline",type:"uint256"}],internalType:"struct IAllowanceTransfer.PermitSingle",name:"permitSingle",type:"tuple"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ISignatureTransfer.TokenPermissions",name:"permitted",type:"tuple"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct ISignatureTransfer.PermitTransferFrom",name:"permit",type:"tuple"},{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"requestedAmount",type:"uint256"}],internalType:"struct ISignatureTransfer.SignatureTransferDetails",name:"transferDetails",type:"tuple"},{internalType:"address",name:"owner",type:"address"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permitTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ISignatureTransfer.TokenPermissions[]",name:"permitted",type:"tuple[]"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct ISignatureTransfer.PermitBatchTransferFrom",name:"permit",type:"tuple"},{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"requestedAmount",type:"uint256"}],internalType:"struct ISignatureTransfer.SignatureTransferDetails[]",name:"transferDetails",type:"tuple[]"},{internalType:"address",name:"owner",type:"address"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permitTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ISignatureTransfer.TokenPermissions",name:"permitted",type:"tuple"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct ISignatureTransfer.PermitTransferFrom",name:"permit",type:"tuple"},{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"requestedAmount",type:"uint256"}],internalType:"struct ISignatureTransfer.SignatureTransferDetails",name:"transferDetails",type:"tuple"},{internalType:"address",name:"owner",type:"address"},{internalType:"bytes32",name:"witness",type:"bytes32"},{internalType:"string",name:"witnessTypeString",type:"string"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permitWitnessTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{components:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct ISignatureTransfer.TokenPermissions[]",name:"permitted",type:"tuple[]"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"}],internalType:"struct ISignatureTransfer.PermitBatchTransferFrom",name:"permit",type:"tuple"},{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"requestedAmount",type:"uint256"}],internalType:"struct ISignatureTransfer.SignatureTransferDetails[]",name:"transferDetails",type:"tuple[]"},{internalType:"address",name:"owner",type:"address"},{internalType:"bytes32",name:"witness",type:"bytes32"},{internalType:"string",name:"witnessTypeString",type:"string"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"permitWitnessTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint160",name:"amount",type:"uint160"},{internalType:"address",name:"token",type:"address"}],internalType:"struct IAllowanceTransfer.AllowanceTransferDetails[]",name:"transferDetails",type:"tuple[]"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint160",name:"amount",type:"uint160"},{internalType:"address",name:"token",type:"address"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"}];class O{static abi=E;static createInterface(){return new S(E)}static connect(e,t){return new k(e,E,t)}}var R=n(401);BigInt.prototype.toJSON||(BigInt.prototype.toJSON=function(){return this.toString()});const G=!process?.browser&&void 0===globalThis.window;function D(e,t){return[...Array(Math.ceil(e.length/t))].map(((n,a)=>e.slice(t*a,t+t*a)))}function _(e){return new Promise((t=>setTimeout(t,e)))}const N=G?R.webcrypto:globalThis.crypto;async function L(e,t="SHA-256"){return new Uint8Array(await N.subtle.digest(t,e))}async function W(e,t="SHA-256"){return q(await L(j(e),t))}function U(e=32){return N.getRandomValues(new Uint8Array(e))}function H(e){return new Uint8Array(e.buffer)}function V(...e){const t=e.reduce(((e,t)=>e+t.length),0),n=new Uint8Array(t);return e.forEach(((e,t,a)=>{const r=a.slice(0,t).reduce(((e,t)=>e+t.length),0);n.set(e,r)})),n}function j(e){let t="bigint"==typeof e?e.toString(16):e;return t.startsWith("0x")&&(t=t.slice(2)),t.length%2!=0&&(t="0"+t),Uint8Array.from(t.match(/.{1,2}/g).map((e=>parseInt(e,16))))}function q(e){return"0x"+Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("")}function $(e,t=32){return"0x"+BigInt(e).toString(16).padStart(2*t,"0")}function X(e){return Uint8Array.from(atob(e),(e=>e.charCodeAt(0)))}function Q(e){return btoa(e.reduce(((e,t)=>e+String.fromCharCode(t)),""))}function z(e){return q(X(e))}function J(e){return Q(j(e))}const{EventLog:K,UndecodedEventLog:Z,Log:Y}=r;async function ee({address:e,provider:t,contract:n,event:a,fromBlock:r,toBlock:i}){!e&&n?e=n.target:"*"===e&&(e=void 0),!t&&n&&(t=n.runner),a||(a="*"),r||0===r||(r=0),i||0===i||(i="latest");let p=null,o=[null];n&&({fragment:p,topics:o}=await y(n.interface,a));const u={address:e,topics:o,fromBlock:r,toBlock:i};return s(t,"contract runner does not have a provider","UNSUPPORTED_OPERATION",{operation:"queryFilter"}),(await t.getLogs(u)).map((e=>{let a=p;if(null==a&&n)try{a=n.interface.getEvent(e.topics[0])}catch{}if(a&&n)try{return new K(e,n.interface,a)}catch(t){return new Z(e,t)}return new Y(e,t)}))}class te{concurrencySize;blockBatch;txBatch;eventBatch;eventRange;delays;retry;retryMax;retryOn;onProgress;constructor({concurrencySize:e,blockBatch:t,txBatch:n,eventBatch:a,eventRange:r,delays:i,retry:s,retryMax:p,retryOn:o,onProgress:y}){this.concurrencySize=e||10,this.blockBatch=t||10,this.txBatch=n||this.blockBatch,this.eventBatch=a||3,this.eventRange=r||5e3,this.delays=i,this.retry=s??!0,this.retryMax=p||3,this.retryOn=o||500,this.onProgress=y}async createBatchRequest(e,t,n){let a=0;const r=[];for(const i of D(e,this.concurrencySize*n)){const s=(await Promise.all(D(i,n).map((async(e,n)=>(await _(40*n),(async()=>{let n,a=0;for(;!this.retry&&0===a||this.retry&&a<this.retryMax;)try{return await Promise.all(e.map((e=>t(e))))}catch(e){a++,n=e,await _(this.retryOn)}throw n})()))))).flat();r.push(...s),a+=i.length,this.onProgress&&this.onProgress({chunkIndex:a,chunkLength:e.length,chunks:i,resultLength:s.flat().length}),this.delays&&await _(this.delays)}return r}async getBlocks(e,t,n){return await this.createBatchRequest(t,(async t=>{const a=await e.getBlock(t,n);if(!a)throw new Error(`No block for ${t}`);return a}),this.blockBatch)}async getTransactions(e,t){return await this.createBatchRequest(t,(async t=>{const n=await e.getTransaction(t);if(!n)throw new Error(`No tx for ${t}`);return n}),this.txBatch)}async getTransactionReceipts(e,t){return await this.createBatchRequest(t,(async t=>{const n=await e.getTransactionReceipt(t);if(!n)throw new Error(`No tx for ${t}`);return n}),this.txBatch)}async getEvents({address:e,provider:t,contract:n,event:a="*",fromBlock:r=0,toBlock:i}){i||(i=await(t||n?.runner).getBlockNumber());const s=[];for(let e=r;e<i;e+=this.eventRange){const t=e+this.eventRange-1>i?i:e+this.eventRange-1;s.push({fromBlock:e,toBlock:t})}return(await this.createBatchRequest(s,(async({fromBlock:r,toBlock:i})=>e||!n?await ee({address:e,provider:t,contract:n,event:a,fromBlock:r,toBlock:i}):await n.queryFilter(a,r,i)),this.eventBatch)).flat()}}const{Transaction:ne,parseUnits:ae,parseEther:re,ZeroAddress:ie}=r,se="0x420000000000000000000000000000000000000F";async function pe(e,t){const{unsignedSerialized:n}=ne.from({chainId:t?.chainId||10000n,data:t?.data||"0x",gasLimit:t?.gasLimit||1e7,gasPrice:t?.gasPrice||ae("10000","gwei"),nonce:t?.nonce||1e5,to:t?.to instanceof Promise?await(t?.to):t?.to||ie,type:t?.type||0,value:t?.value||re("10000")});return 13n*await e.getL1Fee(n)/10n}const{resolveProperties:oe,Wallet:ye,HDNodeWallet:ue,Transaction:le,TransactionResponse:ce,VoidSigner:de,JsonRpcSigner:me}=r,Te=42161n,be=5000000n,he=500000n,fe=2,ge=1.3,we=2000000n;async function ve(e,t={}){const n=e.appProvider||e.provider,a=e.address||await e.getAddress(),r=await(e.gasPriceBump?.())||fe,i=await(e.gasLimitBump?.())||ge,s=await(e.customPriorityFee?.());if(t.from){if(t.from!==a)throw new Error("Wrong signer for transaction")}else t.from=a;const[p,o,y,u,l]=await Promise.all([t.chainId?void 0:n.getNetwork().then((({chainId:e})=>e)),t.maxFeePerGas||t.gasPrice||0n===t.maxFeePerGas||0n===t.gasPrice?void 0:n.getFeeData(),t.nonce||0===t.nonce?void 0:n.getTransactionCount(a,"pending"),t.txCost||!e.autoValue?void 0:n.getBalance(a),t.l1Fee||!e.opGasPriceOracle?0n:pe(e.opGasPriceOracle,t)]);p&&(t.chainId=p);let c=0n;if(o)if(o.maxFeePerGas||0n===o.maxFeePerGas){t.type||(t.type=2);const e="bigint"==typeof t.maxPriorityFeePerGas?t.maxPriorityFeePerGas:s??(o.maxPriorityFeePerGas||0n),n=o.maxFeePerGas<=e?e+10n:o.maxFeePerGas;t.maxFeePerGas=BigInt(Math.floor(Number(n)*r)),t.maxPriorityFeePerGas=e,delete t.gasPrice,c=t.maxFeePerGas+t.maxPriorityFeePerGas}else(o.gasPrice||0n===o.gasPrice)&&(t.type||0===t.type||(t.type=0),t.gasPrice=o.gasPrice,delete t.maxFeePerGas,delete t.maxPriorityFeePerGas,c=t.gasPrice);else c=t.maxFeePerGas?BigInt(t.maxFeePerGas)+BigInt(t.maxPriorityFeePerGas||0n):BigInt(t.gasPrice||0n);if((y||0===y)&&(t.nonce=y),u&&BigInt(t.value||0)>=u){t.chainId===Te?t.value=u-(c*be+l):t.value=u-(c*he+l);const e=await n.estimateGas(t);t.gasLimit=21000n!==e?BigInt(Math.floor(Number(e)*i)):e,t.value=u-(c*t.gasLimit+l)}if(!t.gasLimit)try{const e=await n.estimateGas(t);t.gasLimit=21000n!==e?BigInt(Math.floor(Number(e)*i)):e}catch(n){if(!e.gasLimitFailover)throw n;t.gasLimit=we}return l&&(t.l1Fee=l),t.txCost||(t.txCost=c*BigInt(t.gasLimit)+l),oe(t)}class Pe extends ye{autoValue;gasPriceBump;gasLimitBump;customPriorityFee;gasLimitFailover;opGasPriceOracle;constructor(e,t,n={}){super(e,t),this.autoValue=n.autoValue??!0,this.gasPriceBump=n.gasPriceBump,this.gasLimitBump=n.gasLimitBump,this.customPriorityFee=n.customPriorityFee,this.gasLimitFailover=n.gasLimitFailover??!1,this.opGasPriceOracle=n.opGasPriceOracle?B.connect(n.opGasPriceOracle,t):void 0}static fromMnemonic(e,t,n=0,a){const r=`m/44'/60'/0'/0/${n}`,{privateKey:i}=ue.fromPhrase(e,void 0,r);return new Pe(i,t,a)}populateTransaction(e){return ve(this,e)}}class Ce extends de{autoValue;gasPriceBump;gasLimitBump;customPriorityFee;gasLimitFailover;opGasPriceOracle;constructor(e,t,n={}){super(e,t),this.autoValue=n.autoValue??!0,this.gasPriceBump=n.gasPriceBump,this.gasLimitBump=n.gasLimitBump,this.customPriorityFee=n.customPriorityFee,this.gasLimitFailover=n.gasLimitFailover??!1,this.opGasPriceOracle=n.opGasPriceOracle?B.connect(n.opGasPriceOracle,t):void 0}populateTransaction(e){return ve(this,e)}async sendTransaction(e){const t=le.from({...await this.populateTransaction(e),from:void 0});return new ce({...t,blockNumber:null,blockHash:null,hash:t.unsignedSerialized,index:0},this.provider)}}class Ie extends me{autoValue;gasPriceBump;gasLimitBump;customPriorityFee;gasLimitFailover;opGasPriceOracle;appProvider;constructor(e,t){super(e,t);const n=e.options||{};this.autoValue=n.autoValue??!0,this.gasPriceBump=n.gasPriceBump,this.gasLimitBump=n.gasLimitBump,this.customPriorityFee=n.customPriorityFee,this.gasLimitFailover=n.gasLimitFailover??!1,this.opGasPriceOracle=n.opGasPriceOracle?B.connect(n.opGasPriceOracle,e.appProvider||e):void 0,this.appProvider=e.appProvider}populateTransaction(e){return ve(this,e)}async sendUncheckedTransaction(e){return super.sendUncheckedTransaction(await ve(this,e))}}const{BrowserProvider:Ae}=r;async function Me(e,t,n){try{await t.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${BigInt(e).toString(16)}`}]})}catch(a){if(4902!==a.code&&!t.isTrust)throw a;await t.request({method:"wallet_addEthereumChain",params:[{chainId:`0x${BigInt(e).toString(16)}`,chainName:n?.chainName||"Ethereum",nativeCurrency:{name:n?.chainName||"Ethereum",symbol:n?.chainSymbol||"ETH",decimals:18},rpcUrls:n?.rpcUrl?[n.rpcUrl]:[],blockExplorerUrls:[n?.explorerUrl||"https://etherscan.io"]}]})}}class xe extends Ae{ethereum;appProvider;options;chainChanged;accountsChanged;disconnect;constructor(e,t,n){super(e,t?._network,n),this.ethereum=e,this.appProvider=t,this.options=n,this.chainChanged=n?.chainChanged,this.accountsChanged=n?.accountsChanged,this.disconnect=n?.disconnect}async getSigner(e){const[{address:t},n]=await Promise.all([super.getSigner(e),super.send("eth_chainId",[]).then((e=>BigInt(e)))]),a=this.appProvider?._network.chainId;return a&&n!==a&&await Me(a,this.ethereum,this.options),this.chainChanged&&this.ethereum.on("chainChanged",this.chainChanged),this.accountsChanged&&this.ethereum.on("accountsChanged",this.accountsChanged),this.disconnect&&this.ethereum.on("disconnect",this.disconnect),new Ie(this,t)}static discoverProviders(e,t){return new Promise((n=>{const a=[],r=e=>{a.push(e.detail)};setTimeout((()=>{const i=a.map((({info:n,provider:a})=>new xe(a,e,{...t,providerInfo:n})));window?.removeEventListener("eip6963:announceProvider",r),n(i)}),300),window?.addEventListener("eip6963:announceProvider",r),window?.dispatchEvent(new Event("eip6963:requestProvider"))}))}}function Fe(e,t,n){let a=Number(e.oldestBlock??0),r=0;const i=[];for(;a<Number(e.oldestBlock??0)+t;)i.push({number:a,gasUsedRatio:Number(e.gasUsedRatio?.[r]??0),baseFeePerGas:BigInt(e.baseFeePerGas?.[r]??0),priorityFeePerGas:e.reward?.[r]?.map((e=>BigInt(e)))||[]}),a++,r++;n&&i.push({number:"pending",gasUsedRatio:NaN,baseFeePerGas:BigInt(e.baseFeePerGas?.[t]??0),priorityFeePerGas:[]});const{baseFeePerGasAvg:s,priorityFeePerGasAvg:p}=i.reduce(((e,t,n)=>(e.baseFeePerGasAvg+=t.baseFeePerGas,t.priorityFeePerGas.forEach(((t,n)=>{e.priorityFeePerGasAvg[n]||(e.priorityFeePerGasAvg[n]=0n),t&&(e.priorityFeePerGasAvg[n]+=t)})),(i.length=n+1)&&(e.baseFeePerGasAvg=e.baseFeePerGasAvg/BigInt(i.length),e.priorityFeePerGasAvg=e.priorityFeePerGasAvg.map((e=>e?e/BigInt(i.length):0n))),e)),{baseFeePerGasAvg:0n,priorityFeePerGasAvg:[]});return{blocks:i,baseFeePerGasAvg:s,priorityFeePerGasAvg:p}}const Be="A mutation operation was attempted on a database that did not allow mutations.";class ke{name;version;options;db;constructor({name:e,version:t=1,stores:n=[]}){this.name=e,this.version=t,-1===n.findIndex((({name:e})=>"keyStore"===e))&&n.push({name:"keyStore"}),this.options={upgrade(e){Object.values(e.objectStoreNames).forEach((t=>{e.deleteObjectStore(t)})),n.forEach((({name:t,keyPath:n,indexes:a})=>{const r=e.createObjectStore(t,{keyPath:n,autoIncrement:!0});Array.isArray(a)&&a.forEach((({name:e,unique:t=!1})=>{r.createIndex(e,e,{unique:t})}))}))}},this.db=this.openDB()}async openDB(){try{if(!window?.idb)return void console.log("IDB library is not available!");const e=await window.idb.openDB(this.name,this.version,this.options);return e.addEventListener("onupgradeneeded",(async()=>{await this.deleteDB()})),e}catch(e){if(e.message.includes(Be))return void console.log("The browser does not support IndexedDB");if(e.message.includes("less than the existing version"))return console.log(`Upgrading DB ${this.name} to ${this.version}`),void await this.deleteDB();console.log(`openDB error: ${e.message}`)}}async deleteDB(){await(window?.idb?.deleteDB(this.name)),this.db=this.openDB(),await this.db}async getItem({storeName:e,key:t}){try{const n=await this.db;if(!n)return;const a=n.transaction(e).objectStore(e);return await a.get(t)}catch(e){throw new Error(`getItem error: ${e.message}`)}}async addItem({storeName:e,key:t,data:n}){try{const a=await this.db;if(!a)return;const r=a.transaction(e,"readwrite");await r.objectStore(e).get(t)||await r.objectStore(e).add(n)}catch(e){throw new Error(`addItem error: ${e.message}`)}}async putItem({storeName:e,key:t="",data:n}){try{const a=await this.db;if(!a)return;const r=a.transaction(e,"readwrite");await r.objectStore(e).put(n,t)}catch(e){throw new Error(`putItem error: ${e.message}`)}}async deleteItem({storeName:e,key:t}){try{const n=await this.db;if(!n)return;const a=n.transaction(e,"readwrite");await a.objectStore(e).delete(t)}catch(e){throw new Error(`putItem error: ${e.message}`)}}async getAll({storeName:e}){try{const t=await this.db;if(!t)return[];const n=t.transaction(e,"readonly");return await n.objectStore(e).getAll()}catch(e){throw new Error(`getAll error: ${e.message}`)}}async clearStore({storeName:e}){try{const t=await this.db;if(!t)return;const n=t.transaction(e,"readwrite");await n.objectStore(e).clear()}catch(e){throw new Error(`clearStore error: ${e.message}`)}}async createTransactions({storeName:e,data:t}){try{const n=await this.db;if(!n)return;const a=n.transaction(e,"readwrite");await a.objectStore(e).add(t),await a.done}catch(e){throw new Error(`Method createTransactions has error: ${e.message}`)}}async createMultipleTransactions({storeName:e,data:t,index:n}){try{const a=await this.db;if(!a)return;const r=a.transaction(e,"readwrite");for(const e of t)e&&await r.store.put({...e,...n})}catch(e){throw new Error(`Method createMultipleTransactions has error: ${e.message}`)}}get(e){return this.getItem({storeName:"keyStore",key:e})}set(e,t){return this.putItem({storeName:"keyStore",key:e,data:t})}del(e){return this.deleteItem({storeName:"keyStore",key:e})}}const Se="0xcA11bde05977b3631167028862bE2a173976CA11";async function Ee(e,t,n={}){const a=t.map((({contract:e,address:t,interface:n,name:a,params:r,allowFailure:i})=>({target:e?.target||t,callData:(e?.interface||n).encodeFunctionData(a,r),allowFailure:i??!1})));return(await e.aggregate3.staticCall(a,n)).map((([e,n],a)=>{const{contract:r,interface:i,name:s}=t[a],p=e&&"0x"!==n?(r?.interface||i).decodeFunctionResult(s,n):n;return Array.isArray(p)&&1===p.length?p[0]:p}))}const{Signature:Oe,MaxUint256:Re}=r;async function Ge(e,t,n=Re,a=Re){const r=e,i=r.runner,[s,p,{chainId:o}]=await Promise.all([r.name(),r.nonces(i.address),i.provider.getNetwork()]);return Oe.from(await i.signTypedData({name:s,version:"1",chainId:o,verifyingContract:r.target},{Permit:[{name:"owner",type:"address"},{name:"spender",type:"address"},{name:"value",type:"uint256"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]},{owner:i.address,spender:t,value:n,nonce:p,deadline:a}))}const De="0x00000000000D6FFc74A8feb35aF5827bf57f6786";async function _e(e,t){const n=t,[a,r]=await Promise.all([n.decimals(),e.getRateToEth(n.target,!0)]);return r*10n**a/10n**18n}const{AbiCoder:Ne,JsonRpcProvider:Le,Network:We,FeeData:Ue,defineProperties:He}=r;function Ve(e){return null==e?null:e.toString()}class je extends Ue{maxPriorityFeePerGasSlow;maxPriorityFeePerGasMedium;constructor(e,t,n,a,r){super(e,t,n),He(this,{gasPrice:"bigint"==typeof e?e:null,maxFeePerGas:"bigint"==typeof t?t:null,maxPriorityFeePerGas:"bigint"==typeof n?n:null,maxPriorityFeePerGasSlow:"bigint"==typeof a?a:null,maxPriorityFeePerGasMedium:"bigint"==typeof r?r:null})}toJSON(){return{_type:"FeeData",gasPrice:Ve(this.gasPrice),maxFeePerGas:Ve(this.maxFeePerGas),maxPriorityFeePerGas:Ve(this.maxPriorityFeePerGas),maxPriorityFeePerGasSlow:Ve(this.maxPriorityFeePerGasSlow),maxPriorityFeePerGasMedium:Ve(this.maxPriorityFeePerGasMedium)}}}class qe extends Le{staticNetwork;#e;feeHistory;subProvider;multicall;multicallAllowFailure;multicallMaxCount;multicallInterval;multicallQueue;multicallTimer;constructor(e,t,n){super(e,t,n),this.feeHistory=n?.feeHistory??!1,this.staticNetwork=(async()=>{if(t)return We.from(t);const a=We.from(await new Le(e).getNetwork());if(n?.chainId&&BigInt(a.chainId)!==BigInt(n.chainId))throw new Error("Wrong network");return a})(),this.subProvider=this.staticNetwork.then((t=>(this.#e=t,new Le(e,t,{...n,staticNetwork:t})))),this.multicall=this.subProvider.then((e=>v.connect(n?.multicall||Se,e))),this.multicallAllowFailure=n?.multicallAllowFailure??!0,this.multicallMaxCount=n?.multicallMaxCount??1e3,this.multicallInterval=n?.multicallInterval??30,this.multicallQueue=[],this.multicallTimer=null}get _network(){return s(this.#e,"network is not available yet","NETWORK_ERROR"),this.#e}async _detectNetwork(){return this.staticNetwork}async getFeeData(){const[e,t,n,[a,r]]=await Promise.all([(async()=>{try{return BigInt(await this.send("eth_gasPrice",[]))}catch{return 0n}})(),(async()=>{const e=await this.getBlock("latest");return e?.baseFeePerGas??null})(),(async()=>{try{return BigInt(await this.send("eth_maxPriorityFeePerGas",[]))}catch{return 0n}})(),(async()=>{try{if(!this.feeHistory)return[null,null];const e=10,{priorityFeePerGasAvg:t}=Fe(await this.send("eth_feeHistory",[e,"pending",[10,25]]),e);return[t[0],t[1]]}catch{return[null,null]}})()]);return new je(e,t,n,a,r)}async _drainCalls(){try{(await(await this.multicall).aggregate3.staticCall(this.multicallQueue.slice(0,this.multicallMaxCount).map((({request:{to:e,data:t}})=>({target:e,callData:t,allowFailure:this.multicallAllowFailure}))))).forEach((([e,t],n)=>{this.multicallQueue[n].resolve({status:e,data:t}),this.multicallQueue[n].resolved=!0}))}catch(e){this.multicallQueue.forEach((t=>{t.reject(e),t.resolved=!0}))}this.multicallQueue=this.multicallQueue.filter((({resolved:e})=>!e)),this.multicallQueue.length?this._drainCalls():this.multicallTimer=null}_queueCall(e,t="0x"){return this.multicallTimer||(this.multicallTimer=setTimeout((()=>{this._drainCalls()}),this.multicallInterval)),new Promise(((n,a)=>{this.multicallQueue.push({request:{to:e,data:t},resolve:n,reject:a,resolved:!1})}))}async _perform(e){if("call"===e.method&&this.multicallMaxCount>0){const{from:t,to:n,value:a,data:r,blockTag:i}=e.transaction;if(!t&&n&&!a&&(!i||"latest"===i)){const{status:e,data:t}=await this._queueCall(n,r);if(e)return t;throw Ne.getBuiltinCallException("call",{to:n,data:r},t)}}return super._perform(e)}}})(),a})()));